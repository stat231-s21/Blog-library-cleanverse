---
title: "ClaraBlog"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(dplyr)
library(robotstxt)
library(datasets)
library(viridis)
library(maps)
library(leaflet)
library(ggnewscale)
```

## R Markdown

```{r}
#read in
path_in <- "/Users/clarapage/Desktop/Blog-library-cleanverse/clara"
ratios.1 <- read_csv(paste0(path_in,"/finalratios.csv"))

#quick updates to dataset
ratios.2 <- ratios.1 %>%
  select(-c(X1)) %>%
  mutate(politics = case_when(dem_votes > rep_votes ~ "1", dem_votes < rep_votes ~ "0")) %>%
  mutate(ratio_overall = admin/delivered) %>%
  mutate(ratio_100 = admin_100/delivered_100)
```

## Including Plots

You can also embed plots, for example:

```{r, echo=FALSE}
#data
usa_states <- map_data(map = "state", region = ".") 
ratio_map <- ratios.2 %>%
  right_join(usa_states, by = c("state" = "region"))

map_dem <- ratio_map %>%
  filter(politics != 0)
map_rep <- ratio_map %>%
  filter(politics != 1)

#overall map
ggplot(ratio_map, aes(x = long, y = lat, group = group
                      , fill = ratio_overall)) +
  geom_polygon(color = "white") +
  theme_void() +
  coord_fixed(ratio = 1.3) +
  labs(fill = "Proportion of Delivered Shots That Were Administered") +
  theme(legend.position="bottom") +
  scale_fill_distiller(palette = "BuPu", direction = "horizantle")

#political map
#new_scale_color()
ggplot(ratio_map, aes(x = long, y = lat, group = group, fill = ratio_overall)) +
  coord_fixed(ratio = 1.3) +
  geom_polygon(data = map_rep, color = "white") +
  theme_void() +
  labs(fill = "Republican Ratios") +
  theme(legend.position="bottom") +
  scale_fill_distiller(palette = "Reds", direction = "horizantle") +
  new_scale_fill() +
  scale_fill_distiller(palette = "PuBu", direction = "horizantle") +
  geom_polygon(data = map_dem, color = "white", aes(x = long, y = lat, group = group, fill = ratio_overall)) +
  theme_void() +
  labs(fill = "Democratic Ratios") +
  theme(legend.position="bottom")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
